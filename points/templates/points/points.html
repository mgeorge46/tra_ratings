{% extends "tra_theme/base.html" %}
{% block title %}Search Motor Rating{% endblock %}
{% block content %}
<div class="profile-progress">
    <h4>{{ user.email }}'s Progress</h4>
    <p>Level: <span id="level"></span></p>
    <div class="progress-bar-container">
        <div id="progress-bar" class="progress-bar"></div>
    </div>
    <p>Points: <span id="current-points"></span> / <span id="next-threshold"></span> (Next: <span id="next-level"></span>)</p>
</div>

<style>
.progress-bar-container {
    width: 100%;
    background: #e0e0e0;
    height: 24px;
    border-radius: 12px;
}
.progress-bar {
    background: #4caf50;
    height: 100%;
    border-radius: 12px;
    width: 0%;
    transition: width 0.5s;
}
</style>

<script>
fetch("/api/user/progress")
  .then(res => res.json())
  .then(data => {
      document.getElementById("level").innerText = data.level;
      document.getElementById("current-points").innerText = data.points;
      document.getElementById("next-level").innerText = data.next_level;
      document.getElementById("next-threshold").innerText = data.points + data.points_needed;
      let percent = (data.points / (data.points + data.points_needed)) * 100;
      document.getElementById("progress-bar").style.width = percent + "%";
  });
</script>

{% endblock %}
